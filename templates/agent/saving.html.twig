{% extends 'agent/layout.html.twig' %}

{% block title %}Agent Savings{% endblock %}

{% block breadcrumbs %}
    <h3 class="kt-subheader__title">Agent Savings</h3>
{% endblock %}

{% block stylesheets %}
    <style>
        .table-show .table-show__label{
            font-weight: normal;
            text-align: left;
            white-space: nowrap;
        }
        .table-show .table-show__select{
            width: auto;
        }
    </style>
{% endblock %}

{% block body %}
    <div class="kt-container  kt-grid__item kt-grid__item--fluid">
        <div class="row">
            <div class="col-12">
                <div class="kt-portlet">
                    <div class="kt-portlet__head">
                        <div class="kt-portlet__head-label">
                            <h3 class="kt-portlet__head-title">
                                Before EXPROP
                            </h3>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="kt-portlet kt-iconbox kt-iconbox--success kt-iconbox--animate-fast">
                    <div class="kt-portlet__body">
                        <div class="kt-iconbox__body">
                            <div class="kt-iconbox__desc text-center" style="width: 100%;">
                                <h3 class="kt-iconbox__title" style="font-size: 42px;">
                                    {{ currencySymbol }} {{ avgLeaseCostBefore }}
                                </h3>
                                <div class="kt-iconbox__content text-center font-weight-bold" style="font-size: 16px;">
                                    Average Lease Cost Before EXPROP
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="kt-portlet kt-iconbox kt-iconbox--info kt-iconbox--animate-fast">
                    <div class="kt-portlet__body">
                        <div class="kt-iconbox__body">
                            <div class="kt-iconbox__desc text-center" style="width: 100%;">
                                <h3 class="kt-iconbox__title" style="font-size: 42px;">
                                    {{ avgEscalationBefore }}%
                                </h3>
                                <div class="kt-iconbox__content text-center font-weight-bold" style="font-size: 16px;">
                                    Average Escalation Before EXPROP
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-12">
                <div class="kt-portlet">
                    <div class="kt-portlet__head">
                        <div class="kt-portlet__head-label">
                            <h3 class="kt-portlet__head-title">
                                After EXPROP
                            </h3>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="kt-portlet kt-iconbox kt-iconbox--warning kt-iconbox--animate-fast">
                    <div class="kt-portlet__body">
                        <div class="kt-iconbox__body">
                            <div class="kt-iconbox__desc text-center" style="width: 100%;">
                                <h3 class="kt-iconbox__title" style="font-size: 42px;">
                                    {{ currencySymbol }} {{ avgLeaseCostAfter }}
                                </h3>
                                <div class="kt-iconbox__content text-center font-weight-bold" style="font-size: 16px;">
                                    Average Lease Cost After EXPROP
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="kt-portlet kt-iconbox kt-iconbox--dark kt-iconbox--animate-fast">
                    <div class="kt-portlet__body">
                        <div class="kt-iconbox__body">
                            <div class="kt-iconbox__desc text-center" style="width: 100%;">
                                <h3 class="kt-iconbox__title" style="font-size: 42px;">
                                    {{ avgEscalationAfter }}%
                                </h3>
                                <div class="kt-iconbox__content text-center font-weight-bold" style="font-size: 16px;">
                                    Average Escalation After EXPROP
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="kt-portlet kt-iconbox kt-iconbox--danger kt-iconbox--animate-fast">
                    <div class="kt-portlet__body">
                        <div class="kt-iconbox__body">
                            <div class="kt-iconbox__desc text-center" style="width: 100%;">
                                <h3 class="kt-iconbox__title" style="font-size: 42px;">
                                    {{ avgSavingPercentage }}%
                                </h3>
                                <div class="kt-iconbox__content font-weight-bold" style="font-size: 16px;">
                                    Average Saving Percentage
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="kt-portlet kt-portlet--mobile">
            <div class="kt-portlet__head kt-portlet__head--lg">
                <div class="kt-portlet__head-label">
                    <h3 class="kt-portlet__head-title">Detailed Lease Savings</h3>
                </div>
                <div class="kt-portlet__head-toolbar">
                    <div class="kt-portlet__head-wrapper">
                        <div class="kt-portlet__head-actions">
                            <a href="{{ path('agent_saving_download') }}?{{ app.request.query.all|url_encode }}" class="btn btn-brand btn-elevate btn-icon-sm">
                                <i class="la la-download"></i>
                                Download
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="kt-portlet__body">
                <form class="kt-form kt-form--fit" method="get" action="{{ path('agent_saving') }}" id="search_form">
                    <div class="row kt-margin-b-20">
                        <div class="col-sm-6 kt-margin-b-10-tablet-and-mobile">
                            <label>Site ID:</label>
                            <input type="text" class="form-control" value="{{ app.request.query.get('number') }}" placeholder="Site ID" name="number">
                        </div>
                        <div class="col-sm-6 kt-margin-b-10-tablet-and-mobile">
                            <label>Site Name:</label>
                            <input type="text" class="form-control" value="{{ app.request.query.get('name') }}" placeholder="Site Name" name="name">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12 text-right">
                            <button type="submit" class="btn btn-primary btn-brand--icon" id="search">
                                <span><i class="la la-search"></i> Search</span>
                            </button>
                            <button type="reset" class="btn btn-secondary btn-secondary--icon" id="reset">
                                <span><i class="la la-close"></i>Reset</span>
                            </button>
                        </div>
                    </div>
                </form>
                <div class="kt-separator kt-separator--border-dashed kt-separator--space-md"></div>
                <div class="row">
                    <div class="col-sm-12">
                        <div class="table-show">
                            <label class="table-show__label">
                                Show
                                <select class="table-show__select custom-select custom-select-sm form-control form-control-sm" id="limitItems">
                                    <option value="10" {{ (app.request.query.get('limit') == 10) ? 'selected' : '' }}>10</option>
                                    <option value="25" {{ (app.request.query.get('limit') == 25 or app.request.query.get('limit') is empty) ? 'selected' : '' }}>25</option>
                                    <option value="50" {{ (app.request.query.get('limit') == 50) ? 'selected' : '' }}>50</option>
                                    <option value="100" {{ (app.request.query.get('limit') == 100) ? 'selected' : '' }}>100</option>
                                </select>
                                entries
                            </label>
                        </div>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table table-bordered" style="width: 1520px">
                        <thead>
                            <tr class="text-center">
                                <th width="75px">Site ID</th>
                                <th width="95px">Site Name</th>
                                <th width="120px">Total Lease Cost (Previous)</th>
                                <th width="90px">Escalation (Previous)</th>
                                <th width="120px">Proposed Total Lease Cost</th>
                                <th width="100px">Total Lease Costs(New)</th>
                                <th width="90px">Escalation (New)</th>
                                <th width="90px">New Lease Term</th>
                                <th width="120px">Agent Monthly Saving</th>
                                <th width="90px">Escalation Saving</th>
                                <th width="80px">Saving %</th>
                                <th width="150px">Total New Lease Contractual Value</th>
                                <th width="160px">Total Proposed Lease Contractual Value</th>
                                <th width="140px">Total Contractual Saving</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if pagination is defined and pagination is not empty %}
                                {% for lease in pagination %}
                                    <tr  class="text-center">
                                        <td>
                                            {% if (userPermissionLease.view is defined and userPermissionLease.view == true) or (userPermissionLease.edit is defined and userPermissionLease.edit == true) %}
                                                <a href="{{ path('lease_edit', {id:lease.id}) }}">{{ lease.site.number }}</a>
                                            {% else %}
                                                {{ lease.site.number }}
                                            {% endif %}
                                        </td>
                                        <td>
                                            {% if (userPermissionLease.view is defined and userPermissionLease.view == true) or (userPermissionLease.edit is defined and userPermissionLease.edit == true) %}
                                                <a href="{{ path('lease_edit', {id:lease.id}) }}">{{ lease.site.name }}</a>
                                            {% else %}
                                                {{ lease.site.name }}
                                            {% endif %}
                                        </td>
                                        <td>{{ currencySymbol }} {{ lease.previousLeaseCost }}</td>
                                        <td class="text-center">{{ lease.oldEscalation }}%</td>
                                        <td>{{ currencySymbol }} {{ lease.proposedCost }}</td>
                                        <td>{{ currencySymbol }} {{ lease.newLeaseCost }}</td>
                                        <td class="text-center">{{ lease.newEscalation }}%</td>
                                        <td>{{ lease.leaseTerm }} {{ (lease.leaseTerm == 1) ? 'month' : 'months' }}</td>
                                        <td>{{ currencySymbol }} {{ lease.agentSaving }}</td>
                                        <td class="text-center">{{ lease.escalationSaving }}%</td>
                                        <td class="text-center">{{ lease.savingPercentage }}%</td>
                                        <td>{{ currencySymbol }} {{ lease.leaseContractualValue }}</td>
                                        <td>{{ currencySymbol }} {{ lease.proposedLeaseContractualValue }}</td>
                                        <td>{{ currencySymbol }} {{ lease.contractualSaving }}</td>
                                    </tr>
                                {% endfor %}
                            {% else %}
                                <tr>
                                    <td colspan="14" class="text-center">Records not found</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
                <div class="navigation mt-3">
                    {% if pagination is defined %}
                        {{ knp_pagination_render(pagination) }}
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('assets/js/pages/agent_saving.js') }}" type="text/javascript"></script>
{% endblock %}
