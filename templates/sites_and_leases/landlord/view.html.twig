{% extends 'sites_and_leases/layout.html.twig' %}

{% block title %}View Landlord{% endblock %}

{% block breadcrumbs %}
    <h3 class="kt-subheader__title">View Landlord</h3>
{% endblock %}

{% block stylesheets %}
    <link href="{{ asset('assets/vendors/custom/datatables/datatables.bundle.css') }}" rel="stylesheet" type="text/css" />
{% endblock %}

{% block body %}
    <div class="kt-container  kt-grid__item kt-grid__item--fluid">

        <div class="kt-portlet">
            <div class="kt-portlet__head kt-portlet__head--lg">
                <div class="kt-portlet__head-label">
                    <h3 class="kt-portlet__head-title">View Landlord</h3>
                </div>
                <div class="kt-portlet__head-toolbar">
                    <div class="kt-portlet__head-wrapper">
                        <div class="kt-portlet__head-actions">
                            {% if userPermission.edit is defined and userPermission.edit == true %}
                                <a href="{{ path('landlord_edit', {id:landlord.id}) }}" class="btn btn-sm btn-brand btn-elevate btn-icon-sm">
                                    <i class="la la-edit"></i>
                                    Edit Landlord
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="kt-portlet__body">
                <div class="kt-section kt-section--first">
                    <h3 class="kt-section__title">Landlord Details</h3>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="kt-section__content">
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Landlord Name:
                                            <span class="kt-font-bolder">
                                                {{ landlord.name }}
                                            </span>
                                        </span>
                                    </div>
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Landlord Type:
                                            <span class="kt-font-bolder">
                                                {{ (landlord.type.name is defined) ? landlord.type.name : '' }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Landlord ID / Registation Number:
                                            <span class="kt-font-bolder">
                                                {{ landlord.number }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <h3 class="kt-section__title kt-section__title-sm mb-0">Landlord Address (Head Office)</h3>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Address 1:
                                            <span class="kt-font-bolder">
                                                {{ landlord.address1 }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Address 2:
                                            <span class="kt-font-bolder">
                                                {{ landlord.address2 }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            City:
                                            <span class="kt-font-bolder">
                                                {{ landlord.city }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Province / State:
                                            <span class="kt-font-bolder">
                                                {{ landlord.state }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Postal Code:
                                            <span class="kt-font-bolder">
                                                {{ landlord.postalCode }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Country:
                                            <span class="kt-font-bolder">
                                                {{ landlord.country }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            BEE Status:
                                            <span class="kt-font-bolder">
                                                {{ (landlord.beeStatus.name is defined) ? landlord.beeStatus.name : '' }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                {% if landlord.beeStatus.id is defined and landlord.beeStatus.id != 1 %}
                                    <div class="form-group form-group-xs row">
                                        <div class="col-sm-12">
                                            <span class="form-control-plaintext">
                                                BEE Certificate Date of Expiry:
                                                <span class="kt-font-bolder">
                                                    {{ (landlord.beeExpiry is not empty) ? landlord.beeExpiry|date('d M Y') : '' }}
                                                </span>
                                            </span>
                                        </div>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h3 class="kt-section__title kt-section__title-sm mb-0">Bank Account Details</h3>
                            <div class="kt-section__content">
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Account Holder:
                                            <span class="kt-font-bolder">
                                                {{ landlord.accountHolder }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Bank Name:
                                            <span class="kt-font-bolder">
                                                {{ landlord.bankName }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Branch Name:
                                            <span class="kt-font-bolder">
                                                {{ landlord.branchName }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Branch Code:
                                            <span class="kt-font-bolder">
                                                {{ landlord.branchCode }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Account Number:
                                            <span class="kt-font-bolder">
                                                {{ landlord.accountNumber }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            Account Type:
                                            <span class="kt-font-bolder">
                                                {{ landlord.accountType }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                <div class="form-group form-group-xs row">
                                    <div class="col-sm-12">
                                        <span class="form-control-plaintext">
                                            VAT Registered:
                                            <span class="kt-font-bolder">
                                                {{ (landlord.vatStatus == true) ? 'Yes' : 'No' }}
                                            </span>
                                        </span>
                                    </div>
                                </div>
                                {% if landlord.vatStatus == true %}
                                    <div class="form-group form-group-xs row">
                                        <div class="col-sm-12">
                                            <span class="form-control-plaintext">
                                                VAT Registration Number:
                                                <span class="kt-font-bolder">
                                                    {{ landlord.vatNumber }}
                                                </span>
                                            </span>
                                        </div>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="kt-section mt-2">
                    <h3 class="kt-section__title">Landlord Contacts</h3>
                    <div class="kt-section__content">
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead>
                                <tr>
                                    <th>Contact Type</th>
                                    <th>Name</th>
                                    <th>Surname</th>
                                    <th>Company</th>
                                    <th>Email</th>
                                    <th>Mobile</th>
                                    <th>Landline</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% if landlordContacts is defined and landlordContacts is not empty %}
                                    {% for landlordContact in landlordContacts %}
                                        <tr>
                                            <td>{{ landlordContact.type.name is defined ? landlordContact.type.name : '' }}</td>
                                            <td>{{ landlordContact.firstName }}</td>
                                            <td>{{ landlordContact.lastName }}</td>
                                            <td>{{ landlordContact.company }}</td>
                                            <td><a href="mailto:{{ landlordContact.email }}">{{ landlordContact.email }}</a></td>
                                            <td><a href="tel:{{ landlordContact.mobile }}">{{ landlordContact.mobile }}</a></td>
                                            <td><a href="tel:{{ landlordContact.landline }}">{{ landlordContact.landline }}</a></td>
                                        </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr class="text-center">
                                        <td colspan="7">Not found landlord contacts</td>
                                    </tr>
                                {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="kt-section mt-2">
                    <h3 class="kt-section__title">Supporting Documents</h3>
                    <div class="kt-section__content">
                        <div class="form-group form-group-xs row">
                            <div class="col-sm-12">
                                <span class="form-control-plaintext">
                                    Supporting Document Status:
                                    <span class="kt-font-bolder">
                                        {{ (landlord.documentStatus.name is defined) ? landlord.documentStatus.name : '' }}
                                    </span>
                                </span>
                            </div>
                        </div>
                        <div class="document-items">
                            <div class="form-group row">
                                {% if landlord.bankDocument is not empty and landlord.bankDocument.path is defined and landlord.bankDocument.path is not empty %}
                                    <div class="col-xl-3 col-md-4 col-sm-6 col-12 mt-2">
                                        <div class="upload-file-container uploaded bg-light">
                                            <a href="{{ landlord.bankDocument.path }}" target="_blank">
                                                <div class="upload-file-container__file-uploaded">
                                                    <span class="text-dark font-weight-bold">
                                                        Proof of Bank Account
                                                    </span>
                                                    <span class="upload-file-container__file-name">
                                                       {{ (landlord.bankDocument.name is defined and landlord.bankDocument.name is not empty) ? landlord.bankDocument.name : '' }}
                                                    </span>
                                                    <span class="upload-file-container__file-date">
                                                        {{ (landlord.bankDocument.created is defined and landlord.bankDocument.created is not empty) ? landlord.bankDocument.created|date('d M Y') : '' }}
                                                    </span>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                {% endif %}
                                {% if landlordDocuments is defined and landlordDocuments is not empty %}
                                    {% for landlordDocument in landlordDocuments %}
                                        <div class="col-xl-3 col-md-4 col-sm-6 col-12 mt-2">
                                            <div class="upload-file-container uploaded bg-light">
                                                <a href="{{ landlordDocument.document }}" target="_blank">
                                                    <div class="upload-file-container__file-uploaded">
                                                    <span class="text-dark font-weight-bold">
                                                        {{ (landlordDocument.type.name is defined) ? landlordDocument.type.name : '' }}
                                                    </span>
                                                        <span class="upload-file-container__file-name">
                                                       {{ (landlordDocument.name is defined and landlordDocument.name is not empty) ? landlordDocument.name : '' }}
                                                    </span>
                                                        <span class="upload-file-container__file-date">
                                                        {{ (landlordDocument.created is defined and landlordDocument.created is not empty) ? landlordDocument.created|date('d M Y') : '' }}
                                                    </span>
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                    {% endfor %}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="kt-section mt-2">
                    <h3 class="kt-section__title">Comments on landlord</h3>
                    <div class="kt-section__content">
                        {% for comment in landlordComments %}
                            {% if loop.index0 != 0 %}
                                <div class="kt-separator kt-separator--border-dashed kt-separator--space-sm"></div>
                            {% endif %}
                            <div class="form-group form-group-xs row">
                                <div class="col-sm-12">
                                    <span class="form-control-plaintext">
                                        Comment:<br>
                                        <span class="kt-font-bolder" style="white-space: pre-line;">{{ comment.comment|raw }}</span>
                                    </span>
                                </div>
                                <div class="col-sm-12">
                                    <span class="form-control-plaintext">
                                        Date Updated:
                                        <span class="kt-font-bolder">{{ comment.updated|date('d M Y H:i') }}</span>
                                    </span>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        {% if (userPermissionLease.view is defined and userPermissionLease.view == true) or (userPermissionLease.edit is defined and userPermissionLease.edit == true) %}
            <div class="kt-portlet kt-portlet--mobile">
                <div class="kt-portlet__head kt-portlet__head--lg">
                    <div class="kt-portlet__head-label">
                        <h3 class="kt-portlet__head-title">Landlord Sites</h3>
                    </div>
                </div>

                <div class="kt-portlet__body">
                    <table class="table table-striped- table-bordered table-hover table-checkable" id="kt_table_1">
                        <thead>
                        <tr>
                            <th>Site ID</th>
                            <th>Site Name</th>
                            <th>Lease Start Date</th>
                            <th>Lease End Date</th>
                            <th>Total Monthly Rent (Current)</th>
                            <th>Escalation</th>
                        </tr>
                        </thead>
                        <tbody>
                            {% for lease in leases %}
                                <tr>
                                    <td><a href="{{ path('lease_edit', {id:lease.id}) }}">{{ lease.site.number }}</a></td>
                                    <td><a href="{{ path('lease_edit', {id:lease.id}) }}">{{ lease.site.name }}</a></td>
                                    <td>{{ lease.startDate|date('d M Y') }}</td>
                                    <td>{{ lease.endDate|date('d M Y') }}</td>
                                    <td>{{ currencySymbol }} {{ lease.currentTotalCost }}</td>
                                    <td>{{ lease.escalation }}%</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        {% endif %}
    </div>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('assets/vendors/custom/datatables/datatables.bundle.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/js/pages/landlord_view.js') }}" type="text/javascript"></script>
{% endblock %}
